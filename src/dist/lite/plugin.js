/* Source version: 1.2.11 */
(function(g){var u={Events:{INIT:"lite:init",ACCEPT:"lite:accept",REJECT:"lite:reject",SHOW_HIDE:"lite:showHide",TRACKING:"lite:tracking",CHANGE:"lite:change",HOVER_IN:"lite:hover-in",HOVER_OUT:"lite:hover-out"},Commands:{TOGGLE_TRACKING:"lite-toggletracking",TOGGLE_SHOW:"lite-toggleshow",ACCEPT_ALL:"lite-acceptall",REJECT_ALL:"lite-rejectall",ACCEPT_ONE:"lite-acceptone",REJECT_ONE:"lite-rejectone",TOGGLE_TOOLTIPS:"lite-toggletooltips"}},p={show:true,path:"js/opentip-adapter.js",classPath:"OpentipAdapter",cssPath:"css/opentip.css",delay:500},s="%a by %u %t",h=/^[\s\r\n]*$/,w=[{regex:/[\s]*title=\"[^\"]+\"/g,replace:""},{regex:/[\s]*data-selected=\"[^\"]+\"/g,replace:""}],l=[],v=[g.CTRL+88,g.CTRL+120,g.SHIFT+46];function d(E){var A,z,D,C,y,F;if(E.nodeType===ice.dom.ELEMENT_NODE){var B=E.childNodes;for(C=0;C<B.length;++C){F=B[C];d(F);z=F.nodeName.toLowerCase();if(z==="ins"||z==="del"){while(F.firstChild){E.insertBefore(F.firstChild,F)}E.removeChild(F)}}}z=E.nodeName.toLowerCase();if(z==="ins"||z==="del"){A=jQuery.makeArray(E.childNodes)}else{A=[E]}return A}function i(y){if(!y||!y.length){return[]}var z=[];y.forEach(function(A){z=z.concat(d(A))});return z}function n(y){return v.indexOf(y)>=0}function k(y){if(y&&y.$&&(typeof y.getDocument==="function")){return y.$}return y}function m(z){for(var y=l.length;y--;){var A=l[y];if(A.editor==z){return y}}return -1}function c(y){var z=m(y);return z>=0?l[z]:null}function o(y){var z=c(y);return z&&z.plugin}function r(y,z){l.push({plugin:z,editor:y})}function t(A,B,y,D){if(null===A||(typeof(A)=="undefined")){A=""}else{A=String(A)}y=String(y);var C=y.length;for(var z=A.length;z<B;z+=C){if(D){A+=y}else{A=y+A}}return A}function x(y,z){return t(y,z,"0")}function a(A){var z=new Date(),E=z.getDate(),C=z.getMonth(),D=z.getFullYear(),B,F;var G=typeof(A);if(G=="string"||G=="number"){A=new Date(A)}var y=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(E==A.getDate()&&C==A.getMonth()&&D==A.getFullYear()){B=Math.floor((z.getTime()-A.getTime())/60000);if(B<1){return"now"}else{if(B<2){return"1 minute ago"}else{if(B<60){return(B+" minutes ago")}else{F=A.getHours();B=A.getMinutes();return"on "+x(F,2)+":"+x(B,2,"0")}}}}else{if(D==A.getFullYear()){return"on "+y[A.getMonth()]+" "+A.getDate()}else{return"on "+y[A.getMonth()]+" "+A.getDate()+", "+A.getFullYear()}}}g.plugins.add("lite",{icons:"lite-acceptall,lite-acceptone,lite-rejectall,lite-rejectone,lite-toggleshow,lite-toggletracking",hidpi:true,props:{deleteTag:"del",insertTag:"ins",deleteClass:"ice-del",insertClass:"ice-ins",attributes:{changeId:"data-cid",userId:"data-userid",userName:"data-username",sessionId:"data-session-id",changeData:"data-changedata",time:"data-time",lastTime:"data-last-change-time"},stylePrefix:"ice-cts",preserveOnPaste:"p",css:"css/lite.css"},_scriptsLoaded:null,init:function(F){var C=c(F);if(C){return}if(!this._inited){e();this._inited=true}var K=this.path,E=new f(this.props,K),y=g.tools.extend({},F.config.lite||{}),H=y.tooltips;if(undefined==H){H=true}if(H===true){H=p}y.tooltips=H;r(F,E);E.init(F,y);F.on("destroy",(function(L){var M=m(L);if(M>=0){l.splice(M,1)}}).bind(this));if(this._scriptsLoaded){E._onScriptsLoaded();return}else{if(this._scriptsLoaded===false){return}}this._scriptsLoaded=false;var z=(typeof(jQuery)=="function"),J=this,A=y.jQueryPath||"js/jquery.min.js",B=(y.includeType?y["includes_"+y.includeType]:y.includes)||["lite-includes.js"];B=B.slice();for(var D=0,G=B.length;D<G;++D){B[D]=K+B[D]}if(!z){B.splice(0,0,this.path+A)}if(H.path){B.push(this.path+H.path)}var I=function(){if(B.length<1){J._scriptsLoaded=true;if(!z){jQuery.noConflict()}jQuery.each(l,(function(M,N){N.plugin._onScriptsLoaded()}))}else{var L=B.shift();g.scriptLoader.load(L,function(){I()},J)}};I(B)},findPlugin:function(y){return o(y)},startNewSession:function(y){var z=o(y);if(z){z.startNewSession()}else{b("startNewSession: plugin not found")}}});var f=function(y,z){this.props=g.tools.clone(y);this.path=z};f.prototype={init:function(F,B){this._editor=F;this._domLoaded=false;this._editor=null;this._tracker=null;this._isVisible=true;this._liteCommandNames=[];this._canAcceptReject=true;this._removeBindings=[];F.ui.addToolbarGroup("lite");this._setPluginFeatures(F,this.props);this._changeTimeout=null;this._notifyChange=this._notifyChange.bind(this);this._notifyTextChange=this._notifyTextChange.bind(this);this._config=B;var y=B.acceptRejectInReadOnly===true;var z=[{command:u.Commands.TOGGLE_TRACKING,exec:this._onToggleTracking,title:"Toggle Tracking Changes",trackingOnly:false},{command:u.Commands.TOGGLE_SHOW,exec:this._onToggleShow,title:"Toggle Tracking Changes",readOnly:true},{command:u.Commands.ACCEPT_ALL,exec:this._onAcceptAll,title:"Accept all changes",readOnly:y},{command:u.Commands.REJECT_ALL,exec:this._onRejectAll,title:"Reject all changes",readOnly:y},{command:u.Commands.ACCEPT_ONE,exec:this._onAcceptOne,title:"Accept Change",readOnly:y},{command:u.Commands.REJECT_ONE,exec:this._onRejectOne,title:"Reject Change",readOnly:y},{command:u.Commands.TOGGLE_TOOLTIPS,exec:this._onToggleTooltips,readOnly:true}];this._isTracking=B.isTracking!==false;this._eventsBounds=false;F.on("contentDom",(function(J){this._onDomLoaded(J)}).bind(this));F.on("dataReady",(function(J){this._onAfterSetData(J)}).bind(this));var I=this.path;var A=B.commands||[u.Commands.TOGGLE_TRACKING,u.Commands.TOGGLE_SHOW,u.Commands.ACCEPT_ALL,u.Commands.REJECT_ALL,u.Commands.ACCEPT_ONE,u.Commands.REJECT_ONE];var H=this;function E(K){F.addCommand(K.command,{exec:K.exec.bind(H),readOnly:K.readOnly||false});if(K.title&&A.indexOf(K.command)>=0){var J=H._commandNameToUIName(K.command);F.ui.addButton(J,{label:K.title,command:K.command,toolbar:"lite"});if(K.trackingOnly!==false){H._liteCommandNames.push(K.command)}}}for(var D=0,G=z.length;D<G;++D){E(z[D])}if(F.addMenuItems){F.addMenuGroup("lite",50);var C={};C[u.Commands.ACCEPT_ONE]={label:"Accept Change",command:u.Commands.ACCEPT_ONE,group:"lite",order:1,icon:I+"icons/accept_one.png"};C[u.Commands.REJECT_ONE]={label:"Reject Change",command:u.Commands.REJECT_ONE,group:"lite",order:2,icon:I+"icons/reject_one.png"};F.addMenuItems(C)}if(F.contextMenu){F.contextMenu.addListener((function(K){if(K&&this._tracker&&this._tracker.currentChangeNode(K)){var J={};J[u.Commands.ACCEPT_ONE]=g.TRISTATE_OFF;J[u.Commands.REJECT_ONE]=g.TRISTATE_OFF;return J}else{return null}}).bind(this))}},toggleTracking:function(y,z){if("boolean"===typeof z){z={notify:z}}z=z||{};var E=(undefined===y)?!this._isTracking:y,D=this._editor,C=z&&z.force;if(!E&&this._isTracking&&!C){var A=this._tracker.countChanges({verify:true});if(A){return window.alert("Your document containssome pending changes.\nPlease resolve them before turning off change tracking.")}}this._isTracking=E;this._setCommandsState(this._liteCommandNames,E?g.TRISTATE_OFF:g.TRISTATE_DISABLED);this._updateTrackingState();this.toggleShow(E,false);this._setCommandsState(u.Commands.TOGGLE_TRACKING,E?g.TRISTATE_ON:g.TRISTATE_OFF);var B=D.ui.get(this._commandNameToUIName(u.Commands.TOGGLE_TRACKING));if(B){this._setButtonTitle(B,E?"Stop tracking changes":"Start tracking changes")}if(z.notify!==false){D.fire(u.Events.TRACKING,{tracking:E,lite:this})}},toggleShow:function(y,z){var B=(typeof(y)=="undefined")?(!this._isVisible):y;this._isVisible=B;if(this._isTracking){this._setCommandsState(u.Commands.TOGGLE_SHOW,B?g.TRISTATE_ON:g.TRISTATE_OFF)}this._tracker.setShowChanges(B&&this._isTracking);var A=this._editor.ui.get(this._commandNameToUIName(u.Commands.TOGGLE_SHOW));if(A){this._setButtonTitle(A,B?"Hide tracked changes":"Show tracked changes")}if(z!==false){this._editor.fire(u.Events.SHOW_HIDE,{show:B,lite:this})}},isVisible:function(){return this._isVisible},isTracking:function(){return this._isTracking},acceptAll:function(y){this._tracker.acceptAll(y);this._cleanup();this._editor.fire(u.Events.ACCEPT,{lite:this,options:y})},rejectAll:function(y){this._tracker.rejectAll(y);this._cleanup();this._editor.fire(u.Events.REJECT,{lite:this,options:y})},setUserInfo:function(y){y=y||{};this._config.userId=String(y.id);this._config.userName=y.name||"";if(this._tracker){this._tracker.setCurrentUser({id:this._config.userId,name:this._config.userName})}},countChanges:function(y){return((this._tracker&&this._tracker.countChanges(y))||0)},enableAcceptReject:function(y){this._canAcceptReject=!!y;this._onIceChange()},filterIceElement:function(y){if(!y){return true}try{if(y.hasClass(this.props.insertClass)||y.hasClass(this.props.deleteClass)){return false}}catch(y){}return true},startNewSession:function(){var y=new Date();this._sessionId=String.fromCharCode(65+Math.round(Math.random()*26))+y.getDate()+y.getDay()+y.getHours()+y.getMinutes()+y.getMilliseconds();if(this._tracker){this._tracker.setSessionId(this._sessionId)}},getCleanMarkup:function(z){if(null===z||undefined===z){z=(this._editor&&this._editor.getData())||""}for(var y=w.length-1;y>=0;--y){z=z.replace(w[y].regex,w[y].replace)}return z},getCleanText:function(){var y=this._getBody();if(!y){return""}var A=[];A.push("");var z=this._tracker.getDeleteClass();this._getCleanText(y,A,z);var B=A.join("\n");B=B.replace(/&nbsp(;)?/ig," ");return B},acceptChange:function(y){y=k(y);if(y&&this._tracker){this._tracker.acceptChange(y);this._cleanup();this._editor.fire(u.Events.ACCEPT,{lite:this});this._onSelectionChanged(null)}},rejectChange:function(y){y=k(y);if(y&&this._tracker){this._tracker.rejectChange(y);this._cleanup();this._editor.fire(u.Events.REJECT,{lite:this});this._onSelectionChanged(null)}},_getCleanText:function(D,C,B){var A=D.getAttribute("class");if(A&&A.indexOf(B)>=0){return}var y;if(y=((D.nodeName&&D.nodeName.toUpperCase()=="BR")||("block"==jQuery(D).css("display")))){if(h.test(C[C.length-1])){C[C.length-1]=""}else{C.push("")}}for(var E=D.firstChild;E;E=E.nextSibling){var z=E.nodeType;if(3==z){C[C.length-1]+=String(E.nodeValue)}else{if(1==z||9==z||11==z){this._getCleanText(E,C,B)}}}if(y){C.push("")}},_onDomLoaded:function(z){this._domLoaded=true;this._editor=z.editor;var y=this._editor.editable();y.attachListener(y,"keypress",this._onKeyPress,this,null,1);this._hideTooltip();this._onReady()},_onScriptsLoaded:function(){this._scriptsLoaded=true;this._onReady()},_loadCSS:function(B,z){var y=B.getElementsByTagName("head")[0];function A(D,E){var C=jQuery(y).find("#"+E);if(!C.length){C=B.createElement("link");C.setAttribute("rel","stylesheet");C.setAttribute("type","text/css");C.setAttribute("id",E);C.setAttribute("href",D);y.appendChild(C)}}A(this.path+z,"__lite__css__");if(this._config.tooltips.cssPath){A(this.path+this._config.tooltips.cssPath,"__lite_tt_css__")}},_onReady:function(){if(!this._scriptsLoaded||!this._domLoaded){return}setTimeout(this._afterReady.bind(this),5)},_getBody:function(){try{return this._editor.editable().$}catch(y){return null}},_afterReady:function(){var F=this._editor,E=F.document.$,y=this._getBody(),B=this._config,z=(B&&B.debug)||{};this._loadCSS(E,(B&&B.cssPath)||"css/lite.css");if(!this._eventsBounds){this._eventsBounds=true;var D=this._onPaste.bind(this);F.on("afterCommandExec",this._onAfterCommand.bind(this));F.on("beforeCommandExec",this._onBeforeCommand.bind(this));if(this._config.handlePaste){F.on("paste",D,null,null,1)}F.on("beforeGetData",this._onBeforeGetData.bind(this));F.on("beoreUndoImage",this._onBeforeGetData.bind(this));F.on("insertHtml",D,null,null,1);F.on("insertText",D,null,null,1);F.on("insertElement",D,null,null,1);F.on("mode",this._onModeChange.bind(this),null,null,1);F.on("readOnly",this._onReadOnly.bind(this))}if(this._tracker){if(y!=this._tracker.getContentElement()){this._tracker.stopTracking(true);jQuery(this._tracker).unbind();this._tracker=null}}if(this._tracker){return}var A={element:y,mergeBlocks:false,currentUser:{id:B.userId||"",name:B.userName||""},userStyles:B.userStyles,changeTypes:{insertType:{tag:this.props.insertTag,alias:this.props.insertClass,action:"Inserted"},deleteType:{tag:this.props.deleteTag,alias:this.props.deleteClass,action:"Deleted"}},hostMethods:{getHostRange:this._getHostRange.bind(this),getHostRangeData:this._getHostRangeData.bind(this),makeHostElement:function(G){return new g.dom.element(G)},getHostNode:function(G){return G&&G.$},setHostRange:this._setHostRange.bind(this),hostCopy:this._hostCopy.bind(this),beforeEdit:this._beforeEdit.bind(this)}};if(z.log){A.hostMethods.logError=b}A.tooltips=B.tooltips.show;if(A.tooltips){var C=this._hideTooltip.bind(this);A.hostMethods.showTooltip=this._showTooltip.bind(this);A.hostMethods.hideTooltip=C;A.hostMethods.beforeDelete=A.hostMethods.beforeInsert=C;if(B.tooltips.classPath){try{this._tooltipsHandler=new window[B.tooltips.classPath]();A.tooltipsDelay=B.tooltips.delay}catch(F){}if(!this._tooltipsHandler){b("Unable to create tooltip handler",B.tooltips.classPath)}else{this._tooltipsHandler.init(B.tooltips)}}}jQuery.extend(A,this.props);this._tracker=new ice.InlineChangeEditor(A);try{this._tracker.startTracking();this.toggleTracking(this._isTracking,false);this._updateTrackingState();jQuery(this._tracker).on("change",this._onIceChange.bind(this)).on("textChange",this._onIceTextChanged.bind(this));F.fire(u.Events.INIT,{lite:this});this._onSelectionChanged(null);this._onIceChange(null)}catch(F){b("ICE plugin init:",F)}},_onToggleShow:function(){this.toggleShow()},_onToggleTracking:function(){this.toggleTracking()},_onRejectAll:function(){this.rejectAll()},_onAcceptAll:function(){this.acceptAll()},_onAcceptOne:function(){var y=this._tracker.currentChangeNode();return this.acceptChange(y)},_onRejectOne:function(){var y=this._tracker.currentChangeNode();return this.rejectChange(y)},_onToggleTooltips:function(){this._tracker&&this._tracker.toggleTooltips()},_cleanup:function(){var y=this._getBody(),z=jQuery(y).find(self.insertSelector+":empty,"+self.deleteSelector+":empty");z.remove();this._onSelectionChanged(null)},_setButtonTitle:function(y,A){var z=jQuery("#"+y._.id);z.attr("title",A)},_onAfterCommand:function(z){var y=this._tracker&&this._isTracking&&z.data&&z.data.name;if("undo"==y||"redo"==y){this._tracker.reload()}},_onBeforeCommand:function(z){var y=this._tracker&&this._tracker.isTracking()&&z.data&&z.data.name;if("cut"==y){if(j(this._editor,"copy")){this._tracker.prepareToCut()}}else{if("copy"==y){if(j(this._editor,"copy")){this._tracker.prepareToCopy()}}}},_onModeChange:function(y){this._updateTrackingState();setTimeout(this._onIceChange.bind(this),0)},_onKeyPress:function(y){var z=y&&y.data&&y.data.getKeystroke();if(n(z)){y.stop()}},_onKeyDown:function(y){if(!this._tracker||!this._tracker.isTracking()){return}var z=y.data.keyCode;if(n(z)){if(this._tracker.tryToCut()){y.stop()}}},_onBeforeGetData:function(){this._hideTooltip()},_onAfterSetData:function(){this._hideTooltip();this._processContent();if(this._tracker){this._tracker.reload()}},_onReadOnly:function(){this._updateTrackingState()},_updateTrackingState:function(){if(this._tracker){var y=this._isTracking&&this._editor.mode=="wysiwyg"&&!this._editor.readOnly;this._tracker.toggleChangeTracking(y);for(var A=this._removeBindings.length-1;A>=0;--A){this._removeBindings[A].removeListener()}this._removeBindings=[];if(y){var B=this._onSelectionChanged.bind(this),z=this._editor.editable();this._removeBindings.push(this._editor.on("key",function(D){if(this._tracker){var C=D.data.domEvent&&D.data.domEvent.$;return C?!this._tracker.onKeyDown(C):true}return true}.bind(this)));this._removeBindings.push(z.on("keyup",this._onSelectionChanged.bind(this,null,false)));this._removeBindings.push(z.on("click",B));this._removeBindings.push(this._editor.on("selectionChange",B))}}},_onPaste:function(G){if(!this._tracker||!this._isTracking||!G){return true}var A=G.data||{},D=false,B=null,z=(G.name=="insertElement")&&A.$;if(!A){return}if("string"==typeof A){A={dataValue:A,type:"text"}}if(z){D=z.getAttribute("data-track-changes-ignore")}else{if(A.dataValue&&"html"==(A.type||A.mode)){try{z=jQuery(A.dataValue);D=z&&z.attr("data-track-changes-ignore")}catch(C){}}}if(D){return true}if("string"==typeof A.dataValue){try{var F=this._editor.document.$,y=F.createElement("div");y.innerHTML=String(A.dataValue);y=this._tracker.getCleanDOM(y);if(!y.innerHTML){return true}B=jQuery.makeArray(y.childNodes)}catch(C){b("ice plugin paste:",C)}}else{if(z){B=[z]}else{return true}}if(B){B=i(B);var E=this._editor.focusManager.hasFocus;this._beforeInsert();this._tracker.insert({nodes:B});this._afterInsert();if(E){this._editor.editable().focus()}}G.stop();this._onIceTextChanged();return true},_setCommandsState:function(y,B){if(typeof(y)=="string"){y=y.split(",")}for(var z=y.length-1;z>=0;--z){var A=this._editor.getCommand(y[z]);if(A){A.setState(B)}}},_onSelectionChanged:function(A,y){var z=this._isTracking&&this._tracker&&this._tracker.isInsideChange(null,null,y),B=z&&this._canAcceptReject?g.TRISTATE_OFF:g.TRISTATE_DISABLED;this._setCommandsState([u.Commands.ACCEPT_ONE,u.Commands.REJECT_ONE],B)},_onIceChange:function(A){var y=this._isTracking&&this._tracker&&this._tracker.hasChanges();var z=y&&this._canAcceptReject?g.TRISTATE_OFF:g.TRISTATE_DISABLED;this._setCommandsState([u.Commands.ACCEPT_ALL,u.Commands.REJECT_ALL],z);this._onSelectionChanged();if(A){this._triggerChange()}},_onIceTextChanged:function(y){this._triggerChange()},_triggerChange:function(){if(!this._changeTimeout){this._changeTimeout=setTimeout(this._notifyChange,1)}},_notifyChange:function(){this._changeTimeout=null;this._editor.fire(u.Events.CHANGE,{lite:this})},_notifyTextChange:function(){this._changeTimeout=null;this._editor.fire("change",{lite:this})},_processContent:function(){var y=this._getBody(),B=window.jQuery,E=this.props.insertTag,A=this.props.deleteTag,z,C;if(!y){return}C=y.ownerDocument;function D(I,F){var H=I.parentNode,G=C.createElement(F);B.each(I.attributes,function(K,J){G.setAttribute(J.name,J.value)});G.className=I.className||"";B(I).contents().appendTo(G);H.insertBefore(G,I);H.removeChild(I)}if(E!=="span"){z=B(y).find("span."+this.props.insertClass);z.each(function(F,G){D(G,E)})}if(A!=="span"){z=B(y).find("span."+this.props.deleteClass);z.each(function(F,G){D(G,A)})}},_commandNameToUIName:function(y){return y.replace(".","_")},_setPluginFeatures:function(D,F){function B(){return[F.deleteClass,F.insertClass,F.stylePrefix+"*"]}function y(){var H=["title"];for(var I in F.attributes){if(F.attributes.hasOwnProperty(I)){var J=F.attributes[I];if((typeof J==="string")&&J.indexOf("data-")===0){H.push(J)}}}return H}function A(H){var I={};H.forEach(function(J){I[J]=true});return I}if(!D||!D.filter||!D.filter.addFeature){return}try{var z=[],G,C;G={};C={};C.classes=A(B());C.attributes=A(y());G[F.insertTag]=C;G[F.deleteTag]=g.tools.clone(C);G.br=g.tools.clone(C);G.br.propertiesOnly=true;G.span=g.tools.clone(C);D.filter.addFeature({name:"lite-features",allowedContent:G})}catch(E){b(E)}},_setHostRange:function(y){var z=this._editor&&this._editor.getSelection();if(z){z.selectRanges([y])}},_beforeEdit:function(){g.iscutting=true;var z=this._editor,y=function(){z.fire("saveSnapshot")};y();setTimeout(function(){g.iscutting=false},100)},_hostCopy:function(){try{if(g.env.ie){q(this._editor,"copy")}else{this._editor.document.$.execCommand("copy",false,null)}}catch(y){b(y)}},_getHostRange:function(){var A=this._editor&&this._editor.getSelection(),y=A&&A.getRanges(),z=y&&y[0];return z||null},_getHostRangeData:function(y){y=y||this._getHostRange();if(!y){return null}return{startContainer:y.startContainer&&y.startContainer.$,endContainer:y.endContainer&&y.endContainer.$,startOffset:y.startOffset,endOffset:y.endOffset}},_showTooltip:function(z,B){var y=this._config.tooltips;if(y.events){return this._editor&&this._editor.fire(u.Events.HOVER_IN,{lite:this,node:z,changeId:B.changeId})}if(y.show){var A=this._makeTooltipTitle(B);if(this._tooltipsHandler){this._tooltipsHandler.hideAll(this._getBody());this._tooltipsHandler.showTooltip(z,A,this._editor.container.$)}else{z.setAttribute("title",A)}}},_hideTooltip:function(A){var z=this._config.tooltips;if(z.events){return this._editor&&this._editor.fire(u.Events.HOVER_OUT,{lite:this,node:A})}if(this._tooltipsHandler){if(A){this._tooltipsHandler.hideTooltip(A)}else{this._tooltipsHandler.hideAll(this._getBody())}}else{if(this._tracker){if(A){A.removeAttribute("title")}else{var y=this._tracker.getIceNodes();if(y){y.removeAttr("title")}}}}},_beforeInsert:function(){this._editor.fire("saveSnapshot")},_afterInsert:function(){var y=this._editor;y.getSelection().scrollIntoView()},_makeTooltipTitle:function(B){var A=this._config.tooltipTemplate||s,z=new Date(B.time),y=new Date(B.lastTime);A=A.replace(/%a/g,"insert"==B.type?"added":"deleted");A=A.replace(/%t/g,a(z));A=A.replace(/%u/g,B.userName);A=A.replace(/%dd/g,x(z.getDate(),2));A=A.replace(/%d/g,z.getDate());A=A.replace(/%mm/g,x(z.getMonth()+1,2));A=A.replace(/%m/g,z.getMonth()+1);A=A.replace(/%yy/g,x(z.getYear()-100,2));A=A.replace(/%y/g,z.getFullYear());A=A.replace(/%nn/g,x(z.getMinutes(),2));A=A.replace(/%n/g,z.getMinutes());A=A.replace(/%hh/g,x(z.getHours(),2));A=A.replace(/%h/g,z.getHours());A=A.replace(/%T/g,a(y));A=A.replace(/%DD/g,x(y.getDate(),2));A=A.replace(/%D/g,y.getDate());A=A.replace(/%MM/g,x(y.getMonth()+1,2));A=A.replace(/%M/g,y.getMonth()+1);A=A.replace(/%YY/g,x(y.getYear()-100,2));A=A.replace(/%Y/g,y.getFullYear());A=A.replace(/%NN/g,x(y.getMinutes(),2));A=A.replace(/%N/g,y.getMinutes());A=A.replace(/%HH/g,x(y.getHours(),2));A=A.replace(/%H/g,y.getHours());return A}};function b(){var y=window.console;if(y&&y.error){y.error.apply(y,[].slice.call(arguments))}}function j(y,A){if(g.env.ie){return q(y,A)}try{return y.document.$.execCommand(A,false,null)}catch(z){return false}}function q(A,D){var B=A.document,y=B.getBody(),z=false,C,E=function(){z=true};y.on(D,E);C=(g.env.version>7?B.$:B.$.selection.createRange())["execCommand"](D,false);y.removeListener(D,E);return C||z}function e(){Function.prototype.bind=Function.prototype.bind||function(){var A=this,z=Array.prototype.slice.call(arguments),y=z.shift();return function(){return A.apply(y,z.concat(Array.prototype.slice.call(arguments)))}}}})(window.CKEDITOR);
/* Copyright (C) 2015 LoopIndex - All Rights Reserved
 * You may use, distribute and modify this code under the
 * terms of the LoopIndex Comments CKEditor plugin license.
 *
 * You should have received a copy of the LoopIndex Comments CKEditor plugin license with
 * this file. If not, please write to: loopindex@gmail.com, or visit http://www.loopindex.com
 * written by (David *)Frenkiel (https://github.com/imdfl) 
 */